const unsetEverything = "font: unset!important; font-feature-settings: unset!important; font-kerning: unset!important; font-optical-sizing: unset!important; font-variation-settings: unset!important; text-orientation: unset!important; text-rendering: unset!important; -webkit-font-smoothing: unset!important; -webkit-locale: unset!important; -webkit-text-orientation: unset!important; -webkit-writing-mode: unset!important; writing-mode: unset!important; zoom: unset!important; place-content: unset!important; place-items: unset!important; place-self: unset!important; alignment-baseline: unset!important; animation: unset!important; appearance: unset!important; backdrop-filter: unset!important; backface-visibility: unset!important; background: unset!important; background-blend-mode: unset!important; baseline-shift: unset!important; block-size: unset!important; border-block: unset!important; border: unset!important; border-radius: unset!important; border-collapse: unset!important; border-inline: unset!important; inset: unset!important; box-shadow: unset!important; box-sizing: unset!important; break-after: unset!important; break-before: unset!important; break-inside: unset!important; buffered-rendering: unset!important; caption-side: unset!important; caret-color: unset!important; clear: unset!important; clip: unset!important; clip-path: unset!important; clip-rule: unset!important; color-interpolation: unset!important; color-interpolation-filters: unset!important; color-rendering: unset!important; color-scheme: unset!important; columns: unset!important; column-fill: unset!important; gap: unset!important; column-rule: unset!important; column-span: unset!important; contain: unset!important; contain-intrinsic-size: unset!important; content: unset!important; content-visibility: unset!important; counter-increment: unset!important; counter-reset: unset!important; counter-set: unset!important; cursor: unset!important; cx: unset!important; cy: unset!important; d: unset!important; display: unset!important; dominant-baseline: unset!important; empty-cells: unset!important; fill: unset!important; fill-opacity: unset!important; fill-rule: unset!important; filter: unset!important; flex: unset!important; flex-flow: unset!important; float: unset!important; flood-color: unset!important; flood-opacity: unset!important; grid: unset!important; grid-area: unset!important; height: unset!important; hyphens: unset!important; image-orientation: unset!important; image-rendering: unset!important; inline-size: unset!important; inset-block: unset!important; inset-inline: unset!important; isolation: unset!important; letter-spacing: unset!important; lighting-color: unset!important; line-break: unset!important; list-style: unset!important; margin-block: unset!important; margin: unset!important; margin-inline: unset!important; marker: unset!important; mask: unset!important; mask-type: unset!important; max-block-size: unset!important; max-height: unset!important; max-inline-size: unset!important; max-width: unset!important; min-block-size: unset!important; min-height: unset!important; min-inline-size: unset!important; min-width: unset!important; mix-blend-mode: unset!important; object-fit: unset!important; object-position: unset!important; offset: unset!important; opacity: 1; order: unset!important; origin-trial-test-property: unset!important; orphans: unset!important; outline: unset!important; outline-offset: unset!important; overflow-anchor: unset!important; overflow-wrap: unset!important; overflow: unset!important; overscroll-behavior-block: unset!important; overscroll-behavior-inline: unset!important; overscroll-behavior: unset!important; padding-block: unset!important; padding: unset!important; padding-inline: unset!important; page: unset!important; page-orientation: unset!important; paint-order: unset!important; perspective: unset!important; perspective-origin: unset!important; pointer-events: unset!important; position: unset!important; quotes: unset!important; r: unset!important; resize: unset!important; ruby-position: unset!important; rx: unset!important; ry: unset!important; scroll-behavior: unset!important; scroll-margin-block: unset!important; scroll-margin: unset!important; scroll-margin-inline: unset!important; scroll-padding-block: unset!important; scroll-padding: unset!important; scroll-padding-inline: unset!important; scroll-snap-align: unset!important; scroll-snap-stop: unset!important; scroll-snap-type: unset!important; shape-image-threshold: unset!important; shape-margin: unset!important; shape-outside: unset!important; shape-rendering: unset!important; size: unset!important; speak: unset!important; stop-color: unset!important; stop-opacity: unset!important; stroke: unset!important; stroke-dasharray: unset!important; stroke-dashoffset: unset!important; stroke-linecap: unset!important; stroke-linejoin: unset!important; stroke-miterlimit: unset!important; stroke-opacity: unset!important; stroke-width: unset!important; tab-size: unset!important; table-layout: unset!important; text-align: unset!important; text-align-last: unset!important; text-anchor: unset!important; text-combine-upright: unset!important; text-decoration: unset!important; text-decoration-skip-ink: unset!important; text-indent: unset!important; text-overflow: unset!important; text-shadow: unset!important; text-size-adjust: unset!important; text-transform: unset!important; text-underline-offset: unset!important; text-underline-position: unset!important; touch-action: unset!important; transform: unset!important; transform-box: unset!important; transform-origin: unset!important; transform-style: unset!important; transition: opacity 200ms ease-in-out 0ms; user-select: unset!important; vector-effect: unset!important; vertical-align: unset!important; visibility: unset!important; -webkit-app-region: unset!important; border-spacing: unset!important; -webkit-border-image: unset!important; -webkit-box-align: unset!important; -webkit-box-decoration-break: unset!important; -webkit-box-direction: unset!important; -webkit-box-flex: unset!important; -webkit-box-ordinal-group: unset!important; -webkit-box-orient: unset!important; -webkit-box-pack: unset!important; -webkit-box-reflect: unset!important; -webkit-highlight: unset!important; -webkit-hyphenate-character: unset!important; -webkit-line-break: unset!important; -webkit-line-clamp: unset!important; -webkit-mask-box-image: unset!important; -webkit-mask: unset!important; -webkit-mask-composite: unset!important; -webkit-perspective-origin-x: unset!important; -webkit-perspective-origin-y: unset!important; -webkit-print-color-adjust: unset!important; -webkit-rtl-ordering: unset!important; -webkit-ruby-position: unset!important; -webkit-tap-highlight-color: unset!important; -webkit-text-combine: unset!important; -webkit-text-decorations-in-effect: unset!important; -webkit-text-emphasis: unset!important; -webkit-text-emphasis-position: unset!important; -webkit-text-fill-color: unset!important; -webkit-text-security: unset!important; -webkit-text-stroke: unset!important; -webkit-transform-origin-x: unset!important; -webkit-transform-origin-y: unset!important; -webkit-transform-origin-z: unset!important; -webkit-user-drag: unset!important; -webkit-user-modify: unset!important; white-space: unset!important; widows: unset!important; width: unset!important; will-change: unset!important; word-break: unset!important; word-spacing: unset!important; x: unset!important; y: unset!important; z-index: unset!important;"
const englishToLatinDuolingo = JSON.parse("{\"source_to_target_translations\": {\"they do sleep\": [\"dormiunt\"], \"dance\": [\"saltare\", \"saltant\", \"saltatis\"], \"sleep\": [\"dormis\", \"dormiunt\", \"dormit\", \"dormimus\", \"dormire\", \"dormitis\", \"dormio\"], \"chair\": [\"sella\", \"sellam\"], \"children\": [\"pueri\", \"filios\", \"filii\"], \"father\": [\"patrem\", \"pater\"], \"under\": [\"sub\"], \"pleasing\": [\"placet\"], \"the lunch\": [\"prandium\"], \"very\": [\"valde\"], \"rise\": [\"ascendunt\", \"ascendere\"], \"do I visit?\": [\"visito\"], \"fat\": [\"pingues\", \"pinguem\", \"pinguis\"], \"wave\": [\"unda\", \"undam\"], \"sons\": [\"filios\", \"filii\"], \"worst\": [\"pessimus\", \"pessimi\", \"pessima\"], \"parrot\": [\"psittacum\", \"psittacus\", \"psittaco\"], \"mothers\": [\"matres\"], \"tubs\": [\"labra\"], \"brother\": [\"fratrem\", \"frater\"], \"these\": [\"hae\"], \"to paint\": [\"pingere\"], \"are there\": [\"suntne\", \"sunt\"], \"cookies\": [\"crustula\"], \"dinners\": [\"cenas\", \"cenae\"], \"villa\": [\"villam\", \"villa\"], \"to sing\": [\"cantare\"], \"second\": [\"secundum\", \"secunda\", \"secundam\", \"secundus\"], \"a client\": [\"cliens\"], \"cheeses\": [\"casei\"], \"what\": [\"quam\", \"quid\"], \"sweetly\": [\"suaviter\"], \"the toilets\": [\"latrinae\"], \"can\": [\"potest\", \"possum\", \"posse\", \"potestis\", \"possunt\"], \"you study\": [\"studetis\", \"studes\"], \"climbs\": [\"ascendit\"], \"doing\": [\"se habet\", \"agit\"], \"men\": [\"viri\"], \"young man\": [\"iuvenem\", \"iuvenis\"], \"water\": [\"aquam\", \"aqua\"], \"a head of the house\": [\"paterfamilias\"], \"sing\": [\"cantatis\", \"cantare\", \"cantant\"], \"teacher\": [\"magistram\", \"magistrum\", \"magister\", \"magistra\"], \"boy\": [\"Puer\"], \"daughter\": [\"filia\"], \"forum\": [\"foro\", \"forum\"], \"healthy\": [\"sanae\", \"sanos\", \"sanus\", \"sanum\", \"sana\"], \"study\": [\"studemus\", \"tablino\", \"studet\", \"student\"], \"bookkeeper\": [\"ratiocinator\", \"ratiocinatorem\"], \"the sons\": [\"filii\"], \"climb\": [\"ascendunt\", \"ascendere\", \"ascenditis\"], \"the hour\": [\"hora\", \"horam\"], \"a lararium\": [\"lararium\"], \"a cookie\": [\"crustulum\"], \"to rise\": [\"ascendere\"], \"market\": [\"foro\", \"forum\"], \"senile\": [\"senilem\", \"senilis\", \"seniles\"], \"angry\": [\"irati\", \"irato\", \"irata\", \"iratae\", \"iratos\", \"iratas\", \"iratus\", \"iratum\"], \"to wash\": [\"lavare\"], \"visit\": [\"visitare\", \"visitant\", \"visitamus\", \"visitatis\"], \"to her\": [\"ei\"], \"live\": [\"habitas\", \"habitant\", \"habitat\", \"habito\"], \"in New York\": [\"Novi Eboraci\"], \"is\": [\"estne\", \"est\", \"agit\"], \"surely not\": [\"num\"], \"American\": [\"americanus\", \"americana\"], \"the female teacher\": [\"magistra\"], \"parrots\": [\"psittaci\", \"psittacos\"], \"orator\": [\"orator\", \"oratorem\"], \"the human\": [\"homo\", \"hominem\"], \"women\": [\"feminae\"], \"me\": [\"me\", \"mihi\", \"ad me\"], \"hour\": [\"hora\", \"horam\"], \"this\": [\"is\", \"hic\", \"hoc\", \"haec\"], \"you all are\": [\"estis\"], \"learn\": [\"discunt\", \"disco\"], \"my\": [\"meas\", \"mea\", \"britannia\", \"meos\", \"meo\", \"mihi\", \"mei\", \"meus\", \"meum\", \"meae\", \"meam\"], \"the men\": [\"viri\"], \"patron\": [\"patronum\", \"patronus\"], \"to destroy\": [\"delere\"], \"fish sauce\": [\"garum\"], \"states\": [\"civitates\"], \"I come\": [\"venio\"], \"salty\": [\"salsos\", \"salsus\", \"salsi\", \"salsum\", \"salsa\", \"salsam\"], \"please\": [\"quaeso\"], \"to collect\": [\"colligere\"], \"sit\": [\"sedere\", \"sedes\", \"sedetis\", \"sedemus\", \"sedent\"], \"orators\": [\"oratores\"], \"he lives\": [\"habitat\"], \"you go\": [\"is\", \"itis\"], \"taverns\": [\"tabernae\"], \"you are going\": [\"is\", \"itis\"], \"sacrifice\": [\"sacrifico\", \"sacrificatis\", \"donum\", \"sacrificas\", \"sacrificant\", \"sacrificare\"], \"after\": [\"post\"], \"you found\": [\"condis\"], \"Female doctors\": [\"medicas\"], \"she builds\": [\"condit\"], \"as well\": [\"quoque\"], \"third\": [\"tertium\", \"tertia\", \"tertiam\", \"tertius\"], \"owls\": [\"bubones\"], \"so\": [\"sic\", \"tam\"], \"villas\": [\"villas\"], \"are living\": [\"habitant\"], \"wine\": [\"vinum\"], \"Neptune, god of the sea\": [\"neptunus\"], \"office\": [\"tablinum\", \"tablino\"], \"you visit\": [\"visitas\", \"visitatis\"], \"before\": [\"ante\"], \"bridges\": [\"pontes\"], \"rapidly\": [\"rapide\"], \"is there\": [\"estne\"], \"I establish\": [\"condo\"], \"dolls\": [\"pupas\", \"pupae\"], \"paterfamilias\": [\"paterfamilias\"], \"lunch\": [\"prandium\"], \"they\": [\"illi\"], \"son\": [\"filius\"], \"bread\": [\"panis\", \"panem\", \"pane\"], \"speaks\": [\"loquitur\"], \"bacchus\": [\"Bacchus\", \"Bacchum\"], \"a biscuit\": [\"crustulum\"], \"the lararium\": [\"lararium\"], \"are you visiting?\": [\"visitas\"], \"to you\": [\"tibi\", \"vobis\"], \"beneath\": [\"sub\"], \"we are studying\": [\"studemus\"], \"house\": [\"domum\", \"villam\", \"domus\", \"villa\"], \"fish\": [\"pisces\", \"piscis\", \"piscem\"], \"with bread\": [\"pane\"], \"fires\": [\"ignes\"], \"books\": [\"volumina\", \"libri\", \"libros\"], \"our\": [\"nostrum\", \"nostra\", \"nostram\", \"nostras\", \"nostri\", \"noster\", \"nostros\"], \"girl\": [\"puella\"], \"the state\": [\"civitas\"], \"is he\": [\"estne\", \"est\"], \"god\": [\"deus\"], \"they live\": [\"habitant\"], \"without doubt\": [\"sine dubio\"], \"washes\": [\"lavat\"], \"to climb\": [\"ascendere\"], \"red\": [\"rubrum\"], \"he visits\": [\"visitat\"], \"Minerva\": [\"minerva\", \"minervam\"], \"Neptune\": [\"Neptunus\", \"Neptunum\"], \"the brothers\": [\"fratres\"], \"houses\": [\"villae\", \"villas\"], \"cookie\": [\"crustulum\"], \"rises\": [\"ascendit\"], \"husbands\": [\"mariti\"], \"conversation\": [\"colloquium\"], \"we have\": [\"habemus\"], \"female students\": [\"discipulae\", \"discipulas\"], \"she visits\": [\"visitat\"], \"cheese\": [\"caseum\", \"caseus\"], \"the doctors\": [\"medici\"], \"waves\": [\"undas\"], \"wash\": [\"lavas\", \"lavatis\", \"lavant\", \"lavo\", \"lavare\"], \"a doll\": [\"pupa\"], \"to send\": [\"mittere\"], \"ring\": [\"anulum\", \"anulus\"], \"lararium\": [\"larario\", \"lararium\"], \"city\": [\"urbs\", \"urbe\", \"urbem\"], \"tired\": [\"fessum\", \"fessa\", \"fessi\", \"fessae\", \"fessus\"], \"girls\": [\"puellas\", \"puellae\"], \"paint\": [\"pingunt\", \"pingit\", \"pingo\", \"pingere\", \"pingitis\"], \"too\": [\"nimis\", \"quoque\"], \"stuffed\": [\"farta\", \"fartus\"], \"white\": [\"candidas\", \"candidus\", \"candidae\", \"candida\", \"candidum\", \"candidam\"], \"man\": [\"vir\", \"virum\"], \"the bath\": [\"balneum\", \"balneo\"], \"we study\": [\"studemus\"], \"old men\": [\"senes\"], \"doctors\": [\"medicae\", \"medicos\", \"medicas\", \"medici\"], \"clients\": [\"clientes\"], \"Female doctor\": [\"medicam\", \"medica\"], \"kind\": [\"benignae\", \"benigna\", \"benignam\", \"benigni\", \"benignum\", \"benignus\"], \"the chairs\": [\"sellas\"], \"tavern\": [\"taberna\", \"tabernam\"], \"a professor\": [\"professor\"], \"bed\": [\"lectum\", \"lectus\", \"lecto\"], \"New York\": [\"Novum Eboracum\"], \"you are visiting\": [\"visitas\", \"visitatis\"], \"lunches\": [\"prandia\"], \"bridge\": [\"pontem\", \"pons\", \"ponte\"], \"have\": [\"habeo\", \"habet\", \"habemus\", \"habetis\", \"habent\"], \"aged\": [\"senilem\", \"senilis\", \"seniles\"], \"a father\": [\"patrem\", \"pater\"], \"sings\": [\"cantat\"], \"that\": [\"is\", \"ille\", \"illum\", \"illa\"], \"also\": [\"quoque\"], \"build\": [\"condit\", \"construit\", \"condis\", \"construunt\"], \"she is\": [\"est\", \"ea est\"], \"destroy\": [\"delent\", \"delet\", \"delere\"], \"we do have\": [\"habemus\"], \"it pleases\": [\"placet\"], \"to dance\": [\"saltare\"], \"you build\": [\"construitis\", \"construis\", \"condis\"], \"fills\": [\"implet\"], \"togas\": [\"togae\", \"togas\"], \"we are\": [\"sumus\"], \"by chance\": [\"forte\"], \"shop\": [\"taberna\", \"tabernam\", \"cauponam\"], \"scrolls\": [\"volumina\"], \"rings\": [\"anuli\", \"anulos\"], \"pleases\": [\"placet\"], \"the toilet\": [\"latrina\"], \"Actors\": [\"histriones\"], \"bedroom\": [\"cubiculo\", \"cubiculum\"], \"it is\": [\"est\"], \"fifth\": [\"quintum\", \"quinta\", \"quintam\", \"quintus\"], \"unhappy\": [\"miser\", \"miseri\", \"miserum\", \"misera\"], \"rich\": [\"pecuniosum\", \"pecuniosae\", \"pecuniosi\", \"pecuniosam\", \"pecuniosus\", \"pecuniosa\"], \"gods\": [\"dei\", \"deos\"], \"do\": [\"faciunt\", \"facimus\"], \"his\": [\"suum\", \"ei\", \"eius\", \"suam\"], \"you establish\": [\"condis\"], \"would you like\": [\"velitis\", \"velisne\"], \"I found\": [\"condo\"], \"do you have\": [\"habesne\", \"habetis\"], \"gem\": [\"gemma\", \"gemmam\"], \"enemy\": [\"hostis\", \"hostem\"], \"household shrines\": [\"lararia\"], \"hello\": [\"salvete\", \"salve\"], \"to us\": [\"nobis\"], \"worried\": [\"sollicitae\", \"sollicitos\", \"sollicitum\", \"sollicitus\", \"sollicitas\", \"sollicita\", \"solliciti\"], \"sacrifices\": [\"dona\", \"sacrificat\", \"sacrificare\"], \"bathhouse\": [\"balneum\", \"balneo\"], \"head of the house\": [\"paterfamilias\"], \"husband\": [\"maritus\", \"maritum\", \"virum\"], \"a husband\": [\"maritum\", \"maritus\"], \"to walk\": [\"ambulare\"], \"humans\": [\"homines\"], \"the tables\": [\"mensas\"], \"are\": [\"suntne\", \"es\", \"sunt\"], \"the mother\": [\"mater\", \"matrem\"], \"collects\": [\"colligit\"], \"are sleeping\": [\"dormiunt\"], \"learns\": [\"discit\"], \"visiting\": [\"visitat\", \"visitamus\"], \"state\": [\"civitas\"], \"you live\": [\"habitas\", \"habitatis\"], \"we\": [\"nos\"], \"the old man\": [\"senem\", \"senex\"], \"toilets\": [\"latrinas\", \"latrinae\"], \"the cities\": [\"urbes\"], \"the dinner\": [\"cena\"], \"tub\": [\"labro\", \"labrum\"], \"cities\": [\"urbes\"], \"ham\": [\"pernam\", \"perna\"], \"hours\": [\"horae\"], \"many\": [\"multas\", \"multa\", \"multi\", \"multae\", \"multos\"], \"patrons\": [\"patroni\", \"patronos\"], \"they sleep\": [\"dormiunt\"], \"there is\": [\"est\"], \"drunk\": [\"ebria\", \"ebrii\", \"ebrius\", \"ebrios\", \"ebrium\", \"ebrias\"], \"walk\": [\"ambulare\", \"ambulamus\", \"ambulatis\", \"ambulant\"], \"dances\": [\"saltat\"], \"table\": [\"mensam\", \"mensa\"], \"speak\": [\"loquuntur\", \"loquor\"], \"olives\": [\"olivae\", \"olivas\"], \"you have\": [\"habes\", \"habetis\"], \"Neptunus\": [\"Neptunus\", \"Neptunum\"], \"quickly\": [\"rapide\", \"celeriter\"], \"to sacrifice\": [\"sacrificare\"], \"a forum\": [\"foro\"], \"the biscuit\": [\"crustulum\"], \"I am coming\": [\"venio\"], \"I do come\": [\"venio\"], \"fire\": [\"ignem\", \"ignis\", \"igne\"], \"surely does not\": [\"num\"], \"those\": [\"illas\", \"illos\", \"illi\", \"illa\", \"illae\"], \"toga\": [\"togam\", \"toga\"], \"the young men\": [\"iuvenes\"], \"the cookie\": [\"crustulum\"], \"the water\": [\"aqua\"], \"irate\": [\"iratus\"], \"an old man\": [\"senex\"], \"is it\": [\"estne\"], \"shops\": [\"cauponas\", \"tabernae\", \"tabernas\", \"cauponae\"], \"larariums\": [\"lararia\"], \"I read\": [\"lego\"], \"sleeping\": [\"dormiunt\"], \"we live\": [\"habitamus\"], \"reads\": [\"legit\"], \"bookkeepers\": [\"ratiocinatores\"], \"sits\": [\"sedet\"], \"doctor\": [\"medicus\", \"medicam\", \"medica\", \"medicum\"], \"perhaps\": [\"forte\", \"fortasse\"], \"daughters\": [\"filiae\", \"filias\"], \"a library\": [\"bibliotheca\"], \"the old men\": [\"senes\"], \"we are living\": [\"habitamus\"], \"the mothers\": [\"matres\"], \"student\": [\"discipulus\", \"discipulo\", \"discipula\"], \"he builds\": [\"condit\"], \"by bread\": [\"pane\"], \"a young man\": [\"iuvenem\", \"iuvenis\"], \"client\": [\"cliens\"], \"a chair\": [\"sella\"], \"mother\": [\"mater\", \"matrem\"], \"the daughters\": [\"filiae\", \"filias\"], \"I would like\": [\"velim\"], \"money\": [\"pecuniam\", \"pecunia\"], \"old man\": [\"senem\", \"senex\"], \"human\": [\"homo\", \"hominem\"], \"bedrooms\": [\"cubicula\"], \"gems\": [\"gemmas\", \"gemmae\"], \"tables\": [\"mensae\", \"mensas\"], \"baths\": [\"balnea\"], \"Bacchus, god of wine\": [\"bacchus\", \"bacchum\"], \"their\": [\"eorum\"], \"I visit\": [\"visito\"], \"The enemy\": [\"hostis\"], \"accountants\": [\"ratiocinatores\"], \"read\": [\"lege\", \"legite\", \"legere\", \"legitis\", \"legunt\", \"legit\"], \"a thief\": [\"fur\"], \"to him\": [\"ei\"], \"early\": [\"mane\"], \"I am visiting\": [\"visito\"], \"I am learning\": [\"disco\"], \"gift\": [\"donum\"], \"chairs\": [\"sellas\", \"sellae\"], \"a human\": [\"homo\"], \"collect\": [\"colligere\", \"colligitis\", \"colligunt\"], \"it lives\": [\"habitat\"], \"to exclaim\": [\"exclamare\"], \"often\": [\"saepe\"], \"doll\": [\"pupa\", \"pupam\"], \"fathers\": [\"patres\"], \"thief\": [\"furem\", \"fur\"], \"library\": [\"bibliothecam\", \"bibliotheca\"], \"to sit\": [\"sedere\"], \"Mars\": [\"mars\"], \"enemies\": [\"hostes\"], \"the fish sauce\": [\"garum\"], \"household shrine\": [\"larario\", \"lararia\", \"lararium\"], \"to hand over\": [\"tradere\"], \"there are\": [\"sunt\"], \"to read\": [\"legere\"], \"paints\": [\"pingit\"], \"biscuit\": [\"crustulum\"], \"the husband\": [\"maritus\"], \"dinner\": [\"cena\", \"cenam\"], \"greatly\": [\"valde\"], \"owl\": [\"bubonem\", \"bubo\"], \"the father\": [\"patrem\", \"pater\"], \"bath\": [\"balneum\", \"balneo\"], \"to eat\": [\"comedere\"], \"destroys\": [\"delet\"], \"your\": [\"tuum\", \"tuam\", \"tuo\", \"tuos\", \"tuae\", \"tui\", \"vestra\", \"vestrum\", \"tuas\", \"tua\", \"tibi\", \"vestri\", \"tuus\", \"vester\"], \"it is pleasing\": [\"placet\"], \"I am reading\": [\"lego\"], \"hand over\": [\"tradunt\", \"tradere\"], \"her\": [\"eius\", \"ei\", \"suam\", \"illam\", \"suum\", \"se\"], \"strict\": [\"severus\", \"severa\", \"severam\", \"severi\", \"severum\"], \"accountant\": [\"ratiocinator\", \"ratiocinatorem\"], \"happy\": [\"laetus\", \"laeti\", \"laeto\", \"laeta\", \"laetum\"], \"offering\": [\"donum\"], \"boys\": [\"pueri\", \"pueros\"], \"a mother\": [\"mater\", \"matrem\"], \"hi\": [\"salve\"], \"Actor\": [\"histrio\", \"histrionem\"], \"eat\": [\"comedere\"], \"he\": [\"is\", \"hic\", \"ille\"], \"builds\": [\"condit\", \"construit\"], \"us\": [\"nos\"], \"to fill\": [\"implere\"], \"they are\": [\"sunt\"], \"toilet\": [\"latrina\"], \"walks\": [\"ambulat\", \"ambulare\"], \"fill\": [\"impletis\", \"implere\", \"implent\"], \"I usually\": [\"soleo\"], \"male students\": [\"discipuli\", \"discipulos\"], \"book\": [\"liber\", \"volumine\", \"volumen\", \"libro\", \"librum\"], \"sick\": [\"aegra\", \"aegri\", \"aegros\", \"aeger\", \"aegram\", \"aegrum\"], \"you\": [\"tu\", \"tibi\", \"te\", \"vos\"], \"I build\": [\"condo\"], \"brothers\": [\"fratres\"], \"students\": [\"discipulas\", \"discipulae\", \"discipuli\", \"discipulos\"], \"visits\": [\"visitat\"], \"gifts\": [\"dona\"], \"young men\": [\"iuvenes\"], \"surely is not\": [\"num\"], \"you are studying\": [\"studetis\", \"studes\"], \"you all\": [\"vos\"], \"beds\": [\"lecti\", \"lectos\"], \"Spanish\": [\"hispanice\"], \"in Spanish\": [\"hispanice\"], \"scroll\": [\"volumen\", \"volumine\"]}}")
const englishToLatinEntries = Object.entries(englishToLatinDuolingo.source_to_target_translations)
console.log('englishToLatinEntries', englishToLatinEntries)
const maxReplacements = 10000
let numReplacements = 0

// Sort entries so longer entries come up first. So we match the longest text if it includes multiple words
englishToLatinEntries.sort(([english], [english2]) => {
	return english2.length - english.length
})
console.log('englishToLatinEntries', englishToLatinEntries)
// case insensitive contains
jQuery.expr[':'].icontains = function(a, i, m) {
	return jQuery(a).text().toUpperCase()
		.indexOf(m[3].toUpperCase()) >= 0;
  }

const buildKnownEnglishWordsSelector = () => {
	const englishCssQueries = englishToLatinEntries.map(([ english ]) => {
		return `*:icontains("${english}")`
	})

	// combine the individiual queries into one massive query with a comma
	return englishCssQueries.join(',')
}
const knownEnglishWordsSelector = buildKnownEnglishWordsSelector()
const injectedCssClasses = '.latin-to-english-wrapper,.latin-to-english,.latin-to-english-tooltip-text'

const getInnerMostEnglishElements = (containerSelector) => {
	if ($(containerSelector).is(injectedCssClasses)) {
		// console.log('returning early', $(containerSelector))
		// return nothing
		return $(null)
	}

	const allEnglishMatchedElements = $(containerSelector).find(knownEnglishWordsSelector)
	const innermostEnglishElements = allEnglishMatchedElements.not(allEnglishMatchedElements.has(allEnglishMatchedElements))

	// filter out any english words that have already been switched (useful if the english and latin are the same)
	const innermostWithoutMarked = innermostEnglishElements.not(injectedCssClasses).not(innermostEnglishElements.has(injectedCssClasses))
	// console.log('innermostWithoutMarked', innermostWithoutMarked)
	return innermostWithoutMarked
}

// match a single english phrase
const createIndividuaEnglishRegexString = (english, latinWords) =>
	// select english phrases, match at word breaks
	`(\\b${english}\\b)`

// match a single english phrase with regex
const createIndividualEnglishRegex = (english, latinWords, flags = 'gi') => {
	const individualEnglishRegex = createIndividuaEnglishRegexString(english, latinWords)
	// wrap in parenthesis, so we can match a single english phrase later and replace their name
	return new RegExp(`(${individualEnglishRegex})`, flags)
}

const buildAllEnglishPhrasesRegex = () => {
	// Build regex to search for any of the english phrases names https://stackoverflow.com/a/185529/3500171

	const englishPhraseRegexStr = englishToLatinEntries
		.map(([english, latinWords]) => createIndividuaEnglishRegexString(english, latinWords)) // (surely is not)
		.join('|') // (surely is not)|(Actor)

	// wrap in parenthesis, so we can match a single english phrases later and replace their name
	// NOTE: Must include 'g' if we want to only match the full pattern
	// include i so it is case insesitive
	return new RegExp(`(${englishPhraseRegexStr})`, 'gi')
}
const allEnglishPhrasesRegex = buildAllEnglishPhrasesRegex()


const findSpecificEnglishPhrase = (text) => {
	let individualEnglishPhraseRegexAll
	let individualEnglishPhraseRegexFirst

	const normalizedText = text.toLowerCase()
	const latinPhrases = englishToLatinDuolingo[normalizedText]
	console.log('normalizedText', normalizedText, 'latinPhrases', latinPhrases)

	// search for the specific possible english phrase we matched, so we can verify they are an english phrase
	const specificEnglishToLatin = englishToLatinEntries.find(([englishPhrase, latinWords]) => {
		individualEnglishPhraseRegexAll = createIndividualEnglishRegex(englishPhrase, latinWords)
		individualEnglishPhraseRegexFirst = createIndividualEnglishRegex(englishPhrase, latinWords, 'i')

		const currentEnglishPhraseMatches = text.match(individualEnglishPhraseRegexAll)
		// if the current english phrase matches contains the potential traitor we matched, then we found the object we are looking for

		return currentEnglishPhraseMatches && currentEnglishPhraseMatches.length > 0
	})

	return {
		specificEnglishToLatin,
		specificEnglishToLatinRegexAll: individualEnglishPhraseRegexAll,
		specificEnglishToLatinRegexFirst: individualEnglishPhraseRegexFirst
	}
}


// https://stackoverflow.com/a/1026087/3500171
function capitalizeFirstLetter(string) {
	return string.charAt(0).toUpperCase() + string.slice(1);
  }

const getMatchesInArray = (regexp, str) => {
	const matches = str.matchAll(regexp);
	const matchesArr = []
	for (const match of matches) {
	  console.log(`Found ${match[0]} start=${match.index} end=${match.index + match[0].length}.`);
		matchesArr.push({
			matchText: match[0],
			startIndex: match.index,
			endIndex: match.index + match[0].length
		})
	}

	return matchesArr
}

const replaceWords = (innerMostNode) => {
	let text = innerMostNode.text()

	// find all potential traitor matches
	// const dirtyMatches = Array.from(text.matchAll(allEnglishPhrasesRegex))
	// Reverse matches so we can loop through it backwards, this way when we replace text we don't affect indexes for future elements
	const verifiedMatches = getMatchesInArray(allEnglishPhrasesRegex, text).reverse()

	// console.log('dirtyMatches', dirtyMatches)
	// console.log('verifiedMatches', verifiedMatches)

	// if we found possible traitors
	if (verifiedMatches && verifiedMatches.length > 0) {
		// const verifiedMatches = dirtyMatches[0].filter(el => el !== undefined)
		console.log('verifiedMatches', verifiedMatches)

		// console.log('matches', verifiedMatches)
		// // loop through each possible traitor we matched
		for (const match of verifiedMatches) {
			const { matchText, startIndex, endIndex } = match
			console.log(`Found ${matchText} start=${startIndex} end=${endIndex}.`);
			console.log(`Matched ${matchText} in \n${text}\nverified matches: ${verifiedMatches}`)

			const { specificEnglishToLatin, specificEnglishToLatinRegexAll, specificEnglishToLatinRegexFirst } = findSpecificEnglishPhrase(matchText)
			console.log('specific phrase (possibly, might be buggy)', specificEnglishToLatin)



			if (specificEnglishToLatin) {

				const specificEnglishToLatinRegexFirst = createIndividualEnglishRegex(matchText, null, 'i')
				console.log('About to replace match', matchText)
				const [englishPhrase, latinWords] = specificEnglishToLatin
				// console.log('about to update text', text)

				const randomIndex = Math.floor(Math.random() * latinWords.length)
				const randomLatinWord = latinWords[randomIndex]

				// If less than 0.2, replace with latin word
				// TODO change 2
				let replacement = Math.random() < 2 ? randomLatinWord : matchText
				const isCapitalized = matchText[0] === matchText[0].toUpperCase()
				if (isCapitalized) {
					replacement = capitalizeFirstLetter(replacement)
					console.log(`Replacing ${matchText} with ${replacement}`)
				}

				numReplacements++
				const html = `<span class='latin-to-english-wrapper' style=\"${unsetEverything}\">` +
						`<abbr class="latin-to-english-tooltip-text" title="${matchText}">` +
						`<span class='latin-to-english'>` +
							`${replacement}` +
							`</span>` +
						`</abbr>` +
					`</span>`

				// TODO slice/splice
				console.log('text before splice', text)
				text = text.slice(0, startIndex) + html + text.slice(endIndex)
				console.log('new text', text)
				// if we found an english word, replace it with latin
			}

		}

		$(innerMostNode).html(text)

		;
	}
}

// Select the node that will be observed for mutations
const targetNode = document.querySelector('body');

// Options for the observer (which mutations to observe)
const config = { childList: true, subtree: true };

// Callback function to execute when mutations are observed
const markNewContent = function(mutationsList, observer) {
    for(let mutation of mutationsList) {
        for (let node of mutation.addedNodes) {
			// if we've replaced enough on the page, stop
			if (numReplacements >= maxReplacements) {
				return
			}
			if (!$(node).is(injectedCssClasses)) {
				// console.log('in is', $(node))
				// find the english phrases
				getInnerMostEnglishElements(node).each(function () {
					replaceWords($(this))
				})
			}
        }
	}
};

chrome.extension.sendMessage({}, function(response) {
	var readyStateCheckInterval = setInterval(function() {
	if (document.readyState === "complete") {
		clearInterval(readyStateCheckInterval);

		// This part of the script triggers when page is done loading
		 console.log("Latin Context Learner Loaded")
		$(() => {

			// Look for all of our english phrases and replace some of them
			getInnerMostEnglishElements('body')
			  .each(function() {
				  // if we've replaced enough on the page, stop
				if (numReplacements >= maxReplacements) {
					return
				}
				replaceWords($(this))
			})

			// Create an observer instance linked to the callback function
			const observer = new MutationObserver(markNewContent);

			// Start observing the target node for configured mutations
			observer.observe(document, config);
		})
	}
	}, 10);
});
